<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Awesome Chat</title>
<style>
body { font-family: Arial, sans-serif; background: #f5f6fa; display: flex; justify-content: center; padding: 30px; }
.chat-container { width: 450px; background: #fff; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); overflow: hidden; display: flex; flex-direction: column; }
.header { background: #4a69bd; color: white; padding: 14px; text-align: center; font-size: 20px; font-weight: bold; }
#chat { flex: 1; height: 400px; overflow-y: auto; padding: 10px; border-bottom: 1px solid #ddd; background: #f8f9fa; }
.msg { margin: 5px 0; padding: 8px 12px; border-radius: 20px; display: inline-block; max-width: 75%; word-wrap: break-word; }
.me { background: #4a69bd; color: white; float: right; clear: both; }
.other { background: #e0e0e0; float: left; clear: both; }
.system { text-align: center; font-size: 12px; color: gray; margin: 5px 0; }
.timestamp { display: block; font-size: 10px; color: #555; margin-top: 2px; }
.input-area { display: flex; padding: 12px; background: #fff; }
.input-area input { flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 20px; outline: none; }
.input-area button { margin-left: 8px; padding: 10px 18px; background: #4a69bd; border: none; border-radius: 20px; color: white; cursor: pointer; }
#typing { font-size: 12px; color: gray; padding-left: 10px; height: 18px; }
</style>
</head>
<body>
<div class="chat-container">
  <div class="header">Awesome Chat</div>
  <div id="chat"></div>
  <div id="typing"></div>
  <div class="input-area">
    <input id="msg" placeholder="Type a message..."/>
    <button id="send">Send</button>
  </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
const chat = document.getElementById('chat');
const typingEl = document.getElementById('typing');
let name = prompt("Enter your nickname:") || "Anonymous";

socket.emit('setName', name);

function appendMessage(txt, type, time) {
  const div = document.createElement('div');
  if (type==='system') {
    div.className='system';
    div.textContent = txt;
  } else {
    div.className='msg '+type;
    div.textContent = txt;
    if(time){ const t=document.createElement('span'); t.className='timestamp'; t.textContent=time; div.appendChild(t);}
  }
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
}

document.getElementById('send').onclick = sendMessage;
document.getElementById('msg').addEventListener('keypress', e => {
  socket.emit('typing');
  if(e.key==='Enter') sendMessage();
});

function sendMessage(){
  const msg = document.getElementById('msg').value.trim();
  if(!msg) return;
  socket.emit('message', {text: msg});
  document.getElementById('msg').value='';
}

socket.on('message', ({sender,text,time})=>{
  const type = sender===name ? 'me' : 'other';
  appendMessage(sender+': '+text, type, time);
});

socket.on('system', txt => appendMessage(txt, 'system'));
socket.on('typing', txt => {
  typingEl.textContent = txt;
  setTimeout(()=>{ typingEl.textContent = '' }, 1500);
});
</script>
</body>
</html>

